<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Linear regression via generalized estimating equations (GEE) — details_linear_reg_gee • multilevelmod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>

<!-- Bootstrap -->
<link href="../tidyverse.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>
<link href="../tidyverse-2.css" rel="stylesheet">

<!--optional theme-->
<link href="../tidymodels.css" rel="stylesheet">




<meta property="og:title" content="Linear regression via generalized estimating equations (GEE) — details_linear_reg_gee" />
<meta property="og:description" content="gee::gee() uses generalized least squares to fit different types of models
that have errors that are not independent." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-115082821-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115082821-1');
</script>

  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a class="navbar-brand" href="../index.html">multilevelmod</a>
        <div class="info hidden-xs hidden-sm">
          <span class="partof">part of <a href="https://github.com/tidymodels">tidymodels</a></span>
          <span class="version version-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
        </div>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Linear regression via generalized estimating equations (GEE)</h1>
    
    <div class="hidden name"><code>details_linear_reg_gee.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code><a href='https://rdrr.io/pkg/gee/man/gee.html'>gee::gee()</a></code> uses generalized least squares to fit different types of models
that have errors that are not independent.</p>
    </div>



    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>For this engine, there is a single mode: regression</p><h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Tuning Parameters</h3>


<p>This model has no formal tuning parameters. It might be beneficial to
determine the appropriate correlation structure to use. However, this
typically does not affect the predicted value of the model but does have
an effect on the inferential results and parameter covariance values.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Translation from parsnip to the original package</h3>
<p><div class="sourceCode r"></p><pre><span class='fu'><a href='https://parsnip.tidymodels.org/reference/linear_reg.html'>linear_reg</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://parsnip.tidymodels.org/reference/set_engine.html'>set_engine</a></span><span class='op'>(</span><span class='st'>"gee"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://parsnip.tidymodels.org/reference/set_args.html'>set_mode</a></span><span class='op'>(</span><span class='st'>"regression"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://parsnip.tidymodels.org/reference/translate.html'>translate</a></span><span class='op'>(</span><span class='op'>)</span>
</pre><p></div></p><pre><span class='co'>## Linear Regression Model Specification (regression)</span>
<span class='co'>## </span>
<span class='co'>## Computational engine: gee </span>
<span class='co'>## </span>
<span class='co'>## Model fit template:</span>
<span class='co'>## multilevelmod::gee_fit(formula = missing_arg(), data = missing_arg(), </span>
<span class='co'>##     family = gaussian)</span>
</pre>

<p><code><a href='gee_fit.html'>multilevelmod::gee_fit()</a></code> is a wrapper model around <code>gee()</code>.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Preprocessing requirements</h3>


<p>There are no specific preprocessing needs. However, it is helpful to
keep the clustering/subject identifier column as factor or character
(instead of making them into dummy variables). See the examples in the
next section.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>Other details</h3>


<p>The model cannot accept case weights.</p>
<p>Both <code>gee:gee(a)</code> and <code>gee:geepack()</code> specifies the id/cluster variable
using an argument <code>id</code> that requires a vector. parsnip doesn’t work that
way so we enable this model to be fit using a artificial function called
<code>id_var()</code> to be used in the formula. So, in the original package, the
call would look like:<div class="sourceCode r"></p><pre><span class='fu'>gee</span><span class='op'>(</span><span class='va'>breaks</span> <span class='op'>~</span> <span class='va'>tension</span>, id <span class='op'>=</span> <span class='va'>wool</span>, data <span class='op'>=</span> <span class='va'>warpbreaks</span>, corstr <span class='op'>=</span> <span class='st'>"exchangeable"</span><span class='op'>)</span>
</pre><p></div></p>
<p>With <code>parsnip</code>, we suggest using the formula method when fitting:<div class="sourceCode r"></p><pre><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span>

<span class='fu'><a href='https://parsnip.tidymodels.org/reference/linear_reg.html'>linear_reg</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://parsnip.tidymodels.org/reference/set_engine.html'>set_engine</a></span><span class='op'>(</span><span class='st'>"gee"</span>, corstr <span class='op'>=</span> <span class='st'>"exchangeable"</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://generics.r-lib.org/reference/fit.html'>fit</a></span><span class='op'>(</span><span class='va'>breaks</span> <span class='op'>~</span> <span class='va'>tension</span> <span class='op'>+</span> <span class='fu'>id_var</span><span class='op'>(</span><span class='va'>wool</span><span class='op'>)</span>, data <span class='op'>=</span> <span class='va'>warpbreaks</span><span class='op'>)</span>
</pre><p></div></p>
<p>When using the general tidymodels infrastructure, it may be better to
use a workflow. In this case, you can add the appropriate columns using
<code>add_variables()</code> then supply the GEE formula when adding the model:<div class="sourceCode r"></p><pre><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://tidymodels.tidymodels.org'>tidymodels</a></span><span class='op'>)</span>

<span class='va'>gee_spec</span> <span class='op'>&lt;-</span> 
  <span class='fu'><a href='https://parsnip.tidymodels.org/reference/linear_reg.html'>linear_reg</a></span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'><a href='https://parsnip.tidymodels.org/reference/set_engine.html'>set_engine</a></span><span class='op'>(</span><span class='st'>"gee"</span>, corstr <span class='op'>=</span> <span class='st'>"exchangeable"</span><span class='op'>)</span>

<span class='va'>gee_wflow</span> <span class='op'>&lt;-</span> 
  <span class='fu'>workflow</span><span class='op'>(</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='co'># The data are included as-is using:</span>
  <span class='fu'>add_variables</span><span class='op'>(</span>outcomes <span class='op'>=</span> <span class='va'>breaks</span>, predictors <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='va'>tension</span>, <span class='va'>wool</span><span class='op'>)</span><span class='op'>)</span> <span class='op'><a href='https://magrittr.tidyverse.org/reference/pipe.html'>%&gt;%</a></span> 
  <span class='fu'>add_model</span><span class='op'>(</span><span class='va'>gee_spec</span>, formula <span class='op'>=</span> <span class='va'>breaks</span> <span class='op'>~</span> <span class='va'>tension</span> <span class='op'>+</span> <span class='fu'>id_var</span><span class='op'>(</span><span class='va'>wool</span><span class='op'>)</span><span class='op'>)</span>

<span class='fu'><a href='https://generics.r-lib.org/reference/fit.html'>fit</a></span><span class='op'>(</span><span class='va'>gee_wflow</span>, data <span class='op'>=</span> <span class='va'>warpbreaks</span><span class='op'>)</span>
</pre><p></div></p>
<p><code>gee()</code> always prints out warnings and output even when <code>silent = TRUE</code>.
When using the <code>gee</code> engine, it will never produce output, even if
<code>silent = FALSE</code>.</p>
<p>Also, because of issues with the <code>gee()</code> function, a supplementary call
to <code><a href='https://rdrr.io/r/stats/glm.html'>glm()</a></code> is needed to get the rank and QR decomposition objects so
that <code><a href='https://rdrr.io/r/stats/predict.html'>predict()</a></code> can be used.</p>

<h3 class='hasAnchor' id='arguments'><a class='anchor' href='#arguments'></a>References</h3>

<ul>
<li><p>Liang, K.Y. and Zeger, S.L. (1986) Longitudinal data analysis using
generalized linear models. <em>Biometrika</em>, 73 13–22.</p></li>
<li><p>Zeger, S.L. and Liang, K.Y. (1986) Longitudinal data analysis for
discrete and continuous outcomes. <em>Biometrics</em>, 42 121–130.</p></li>
</ul>



  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="tidyverse">
  <p>multilevelmod is a part of the <strong>tidymodels</strong> ecosystem, a collection of modeling packages designed with common APIs and a shared philosophy.</p>
</div>

<div class="author">
  <p>
    Developed by Max Kuhn.
    Site built by <a href="https://pkgdown.r-lib.org">pkgdown</a>.
  </p>
</div>

      </footer>
   </div>

  


  </body>
</html>


