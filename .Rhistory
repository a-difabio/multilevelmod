knitr::knit("README.Rmd")
library(dplyr)
source("https://gist.githubusercontent.com/topepo/063bc66e504f5fec13c67c0dcf7b37c6/raw/ebe842d55c37642e8c34165ebaa5bf650008ccee/replicates.R")
exp_data <-
replicates %>%
pivot_longer(
cols = c(starts_with("rep")),
names_to = "replicate",
values_to = "value"
)
library(tidyr)
source("https://gist.githubusercontent.com/topepo/063bc66e504f5fec13c67c0dcf7b37c6/raw/ebe842d55c37642e8c34165ebaa5bf650008ccee/replicates.R")
exp_data <-
replicates %>%
pivot_longer(
cols = c(starts_with("rep")),
names_to = "replicate",
values_to = "value"
)
exp_data
msa_data <- exp_data
usethis::use_data(msa_data)
load("/Users/max/Downloads/riesby.RData")
riesby
library(ggplot2)
ggplot(riesby, aes(x = week, y = depr_score)) + geom_point()
tt <- riesby
tt$imipramine <- tt$imipramine/mean(tt$imipramine)
tt$desipramine <- tt$desipramine/mean(tt$desipramine)
lmer(depr_score ~ week + imipramine + desipramine + (week | subject), data = riesby)
library(lme4)
lmer(depr_score ~ week + imipramine + desipramine + (week | subject), data = riesby)
ggplot(riesby, aes(x = week, y = depr_score)) + geom_point() + facet_wrap(~subject)
both <- lmer(depr_score ~ week + imipramine + desipramine + (week | subject), data = riesby)
int <- lmer(depr_score ~ week + imipramine + desipramine + (1 | subject), data = riesby)
anova(both, int)
none <- lm(depr_score ~ week + imipramine + desipramine, data = riesby)
anova(both, none)
anova(int, none)
names(int)
slotNames(int)
int@frame
int@frame$subject
head(riesby)
riesby$subject <- factor(riesby$subject)
trn <- riesby %>% slice(-(1:4))
trm
trn
both <- lmer(depr_score ~ week + imipramine + desipramine + (week | subject), data = trm)
both <- lmer(depr_score ~ week + imipramine + desipramine + (week | subject), data = trn)
tst <- riesby %>% slice(1:4)
predict(both, tst)
predict(both, tst, allow.new.levels = TRUE)
predict(both, tst, allow.new.levels = TRUE, type = "response")
p1 <- predict(both, trn)
p1 <- predict(both, trn, allow.new.levels = TRUE)
p2 <- predict(both, trn, allow.new.levels = TRUE)
p1 <- predict(both, trn)
p1
p2
plot(p1, p2)
Sitka89
library(MASS)
Sitka89
Sitka89 %>% head()
Sitka89$treat
Sitka89$tree
ggplot(Sitka89, aes(x = Time, y = size, col = treat)) + geom_point()
ggplot(Sitka89, aes(x = Time, y = size, col = treat)) + geom_point() + facet_wrap(~ tree)
long_mod <-
linear_reg() %>%
set_engine("lmer")
# This won't be needed in the future. See
sleep_rec <- recipe(depr_score ~ .,  data = riesb)
library(tidymodels)
long_mod <-
linear_reg() %>%
set_engine("lme4")
sleep_rec <- recipe(depr_score ~ .,  data = riesb)
# This won't be needed in the future. See
sleep_rec <- recipe(depr_score ~ .,  data = riesby)
mm_wlfow <-
workflow() %>%
add_model(long_mod,
formula = depr_score ~ week + imipramine + desipramine + (week | subject)) %>%
add_recipe(sleep_rec)
fit(mm_wlfow, data = riesby)
rs <- group_vfold_cv(riesby, group = subject)
rs
ctrl <- control_resamples(save_pred = TRUE)
fits <-
mm_wlfow %>%
fit_resamples(resamples = rs, control = ctrl)
fits
collect_metrics(fits)
fit_mode <- fit(mm_wlfow, data = riesby)
fit_mode
collect_metrics(fits, summarize = FALSE) %>% filteR(.metric == "rmse") %>% ggplot(aes(x = mean)) + geom_density()
collect_metrics(fits, summarize = FALSE) %>% filter(.metric == "rmse") %>% ggplot(aes(x = mean)) + geom_density()
collect_metrics(fits, summarize = FALSE) %>% filter(.metric == "rmse")
collect_metrics(fits, summarize = FALSE) %>% filter(.metric == "rmse") %>% ggplot(aes(x = .estimate)) + geom_density()
collect_metrics(fits, summarize = FALSE) %>% filter(.metric == "rmse") %>% ggplot(aes(x = .estimate)) + geom_density() + geom_rug()
collect_predictions()
collect_predictions(fits)
collect_predictions(fits) %>% inner_join(riesby %>% mutate(.row = row_number()))
collect_predictions(fits) %>% inner_join(riesby %>% mutate(.row = row_number())) %>% ggplot(aes(x = week, y = depr_score)) + geom_point()
collect_predictions(fits) %>% inner_join(riesby %>% mutate(.row = row_number())) %>% ggplot(aes(x = week, y = depr_score)) + geom_point() + facet_wrap(~ subject)
collect_predictions(fits) %>% inner_join(riesby %>% mutate(.row = row_number())) %>% ggplot(aes(x = week, y = depr_score)) + geom_point() + facet_wrap(~ subject) + geom_path(aes(y = .pred), col = "blue")
use_data(riesby)
usethis:::use_data(riesby)
msa_data
